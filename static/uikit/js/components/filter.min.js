/*! For license information please see filter.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&typeof module<"u"?module.exports=e(require("uikit-util")):"function"==typeof define&&define.amd?define("uikitfilter",["uikit-util"],e):(t=typeof globalThis<"u"?globalThis:t||self).UIkitFilter=e(t.UIkit.util)}(this,(function(t){"use strict";function e(e,i){void 0===i&&(i=!1);let{offsetTop:n,offsetLeft:s,offsetHeight:a,offsetWidth:r}=e;return i&&([n,s]=t.offsetPosition(e)),{top:n,left:s,bottom:n+a,right:s+r}}const i="uk-transition-leave",n="uk-transition-enter";function s(e,s,c,l){void 0===l&&(l=0);const f=a(s,!0),u={opacity:1},h={opacity:0},d=t=>()=>f===a(s)?t():Promise.reject(),p=d((async()=>{t.addClass(s,i),await Promise.all(o(s).map(((e,i)=>new Promise((n=>setTimeout((()=>t.Transition.start(e,h,c/2,"ease").then(n)),i*l)))))),t.removeClass(s,i)})),m=d((async()=>{const i=t.height(s);t.addClass(s,n),e(),t.css(t.children(s),{opacity:0}),await new Promise((t=>requestAnimationFrame(t)));const r=t.children(s),d=t.height(s);t.css(s,"alignContent","flex-start"),t.height(s,i);const p=o(s);t.css(r,h);const m=p.map((async(e,i)=>{await function(t){return new Promise((e=>setTimeout(e,t)))}(i*l),await t.Transition.start(e,u,c/2,"ease")}));i!==d&&m.push(t.Transition.start(s,{height:d},c/2+p.length*l,"ease")),await Promise.all(m).then((()=>{t.removeClass(s,n),f===a(s)&&(t.css(s,{height:"",alignContent:""}),t.css(r,{opacity:""}),delete s.dataset.transition)}))}));return t.hasClass(s,i)?r(s).then(m):t.hasClass(s,n)?r(s).then(p).then(m):p().then(m)}function a(e,i){return i&&(e.dataset.transition=1+a(e)),t.toNumber(e.dataset.transition)||0}function r(e){return Promise.all(t.children(e).filter(t.Transition.inProgress).map((e=>new Promise((i=>t.once(e,"transitionend transitioncanceled",i))))))}function o(i){return function(i){return function(i,n,s){const a=[[]];for(const r of i){if(!t.isVisible(r))continue;let i=e(r);for(let t=a.length-1;t>=0;t--){const o=a[t];if(!o[0]){o.push(r);break}let c;if(o[0].offsetParent===r.offsetParent?c=e(o[0]):(i=e(r,!0),c=e(o[0],!0)),i[n]>=c[s]-1&&i[n]!==c[n]){a.push([r]);break}if(i[s]-1>c[n]||i[n]===c[n]){o.push(r);break}if(0===t){a.unshift([r]);break}}}return a}(i,"top","bottom")}(t.children(i)).reduce(((e,i)=>e.concat(t.sortBy(i.filter((e=>t.isInView(e))),"offsetLeft"))),[])}async function c(e,i,n){await u();let s=t.children(i);const a=s.map((t=>l(t,!0))),r={...t.css(i,["height","padding"]),display:"block"};await Promise.all(s.concat(i).map(t.Transition.cancel)),e(),s=s.concat(t.children(i).filter((e=>!t.includes(s,e)))),await Promise.resolve(),t.fastdom.flush();const o=t.attr(i,"style"),c=t.css(i,["height","padding"]),[h,d]=function(e,i,n){const s=i.map(((e,i)=>!(!t.parent(e)||!(i in n))&&(n[i]?t.isVisible(e)?f(e):{opacity:0}:{opacity:t.isVisible(e)?1:0}))),a=s.map(((s,a)=>{const r=t.parent(i[a])===e&&(n[a]||l(i[a]));if(!r)return!1;if(s){if(!("opacity"in s)){const{opacity:t}=r;t%1?s.opacity=1:delete r.opacity}}else delete r.opacity;return r}));return[s,a]}(i,s,a),p=s.map((e=>({style:t.attr(e,"style")})));s.forEach(((e,i)=>d[i]&&t.css(e,d[i]))),t.css(i,r),await u();const m=s.map(((e,s)=>t.parent(e)===i&&t.Transition.start(e,h[s],n,"ease"))).concat(t.Transition.start(i,c,n,"ease"));try{await Promise.all(m),s.forEach(((e,n)=>{t.attr(e,p[n]),t.parent(e)===i&&t.css(e,"display",0===h[n].opacity?"none":"")})),t.attr(i,"style",o)}catch{t.attr(s,"style",""),function(e,i){for(const n in i)t.css(e,n,"")}(i,r)}}function l(e,i){const n=t.css(e,"zIndex");return!!t.isVisible(e)&&{display:"",opacity:i?t.css(e,"opacity"):"0",pointerEvents:"none",position:"absolute",zIndex:"auto"===n?t.index(e):n,...f(e)}}function f(e){const{height:i,width:n}=t.offset(e);return{height:i,width:n,transform:"",...t.position(e),...t.css(e,["marginTop","marginLeft"])}}function u(){return new Promise((t=>requestAnimationFrame(t)))}var h={props:{duration:Number,animation:Boolean},data:{duration:150,animation:"slide"},methods:{animate(e,i){void 0===i&&(i=this.$el);const n=this.animation;return("fade"===n?s:"delayed-fade"===n?function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return s(...e,40)}:n?c:()=>(e(),Promise.resolve()))(e,i,this.duration).catch(t.noop)}}},d={mixins:[h],args:"target",props:{target:Boolean,selActive:Boolean},data:{target:null,selActive:!1,attrItem:"uk-filter-control",cls:"uk-active",duration:250},computed:{toggles:{get(e,i){let{attrItem:n}=e;return t.$$("["+n+"],[data-"+n+"]",i)},watch(){if(this.updateState(),!1!==this.selActive){const e=t.$$(this.selActive,this.$el);this.toggles.forEach((i=>t.toggleClass(i,this.cls,t.includes(e,i))))}},immediate:!0},children:{get(e,i){let{target:n}=e;return t.$$(n+" > *",i)},watch(t,e){e&&!function(t,e){return t.length===e.length&&t.every((t=>e.includes(t)))}(t,e)&&this.updateState()},immediate:!0}},events:[{name:"click",delegate(){return"["+this.attrItem+"],[data-"+this.attrItem+"]"},handler(t){t.preventDefault(),this.apply(t.current)}}],methods:{apply(e){const i=this.getState(),n=m(e,this.attrItem,this.getState());(function(e,i){return["filter","sort"].every((n=>t.isEqual(e[n],i[n])))})(i,n)||this.setState(n)},getState(){return this.toggles.filter((e=>t.hasClass(e,this.cls))).reduce(((t,e)=>m(e,this.attrItem,t)),{filter:{"":""},sort:[]})},async setState(e,i){void 0===i&&(i=!0),e={filter:{"":""},sort:[],...e},t.trigger(this.$el,"beforeFilter",[this,e]),this.toggles.forEach((i=>t.toggleClass(i,this.cls,!!function(e,i,n){let{filter:s={"":""},sort:[a,r]}=n;const{filter:o="",group:c="",sort:l,order:f="asc"}=p(e,i);return t.isUndefined(l)?c in s&&o===s[c]||!o&&c&&!(c in s)&&!s[""]:a===l&&r===f}(i,this.attrItem,e)))),await Promise.all(t.$$(this.target,this.$el).map((n=>{const s=()=>{(function(e,i,n){const s=function(e){let{filter:i}=e,n="";return t.each(i,(t=>n+=t||"")),n}(e);n.forEach((e=>t.css(e,"display",s&&!t.matches(e,s)?"none":"")));const[a,r]=e.sort;if(a){const e=function(e,i,n){return[...e].sort(((e,s)=>t.data(e,i).localeCompare(t.data(s,i),void 0,{numeric:!0})*("asc"===n||-1)))}(n,a,r);t.isEqual(e,n)||t.append(i,e)}})(e,n,t.children(n)),this.$update(this.$el)};return i?this.animate(s,n):s()}))),t.trigger(this.$el,"afterFilter",[this])},updateState(){t.fastdom.write((()=>this.setState(this.getState(),!1)))}}};function p(e,i){return t.parseOptions(t.data(e,i),["filter"])}function m(e,i,n){const{filter:s,group:a,sort:r,order:o="asc"}=p(e,i);return(s||t.isUndefined(r))&&(a?s?(delete n.filter[""],n.filter[a]=s):(delete n.filter[a],(t.isEmpty(n.filter)||""in n.filter)&&(n.filter={"":s||""})):n.filter={"":s||""}),t.isUndefined(r)||(n.sort=[r,o]),n}return typeof window<"u"&&window.UIkit&&window.UIkit.component("filter",d),d}));